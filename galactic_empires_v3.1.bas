 10  REM *** GALACTIC EMPIRES ***
 20  REM *** VS 3.1+ ************
 30  REM *** BY GEEKCO COMPUTING*
 40  REM *** BEGIN RUN **********
 50  POKE 34,0
 60 V = K
 70 K = I = J
 80 D2 = D1 = D
 90 V1 = V2
 100 DE = A
 110 TRN = TURNS
 120 WRLDS = PLAYERS
 130 AUTBLD = 0
 140  POKE 0,96
 150  DIM FDES(100),FCN(100),FTIM(100),FSTR(100)
 160  DIM LX(40),LY(40),CNT(40),IND(40),SHIPS(40)
 170  DIM IN$(10)
 180  FOR I = 1 TO 100
 190 FDES(I) = 0:FCN(I) = 0:FTIM(I) = 0:FSTR(I) = 0
 200  NEXT I
 210  FOR I = 1 TO 40
 220 LX(I) = 0:LY(I) = 0:CNT(I) = 0:IND(I) = 0:SHIPS(I) = 0
 230  GOSUB 1840
 240  GOSUB 1890
 250  GOSUB 2140
 260  GOSUB 2240
 270  GOSUB 2380
 280  GOSUB 2460
 290  GOSUB 2510
 300  GOSUB 2680
 310  GOSUB 3200
 320  REM *** GAME START ***
 330  FOR TRN = 1 TO TURNS
 340  GOSUB 2830
 350  GOSUB 3020
 360  GOSUB 3090
 370  GOSUB 3200
 380  NEXT TRN
 390  PRINT 
 400  FOR I = 1 TO PLAYERS
 410 LX(I) = 0
 420  NEXT I
 430  FOR I = 1 TO WRLDS
 440  FOR J = 1 TO PLAYERS
 450  IF CNT(I) = J THEN LX(J) = LX(J) + 1
 460  NEXT J
 470  NEXT I
 480  FOR I = 1 TO PLAYERS
 490  PRINT "PLAYER ";I;" HAS ";LX(I);" WORLDS."
 500  NEXT I
 510  END 
 520  REM *** ACTIVATE NOISES **
 530  REM *** ILLEGAL INPUT ****
 540  FOR K = 1 TO 5
 550 NOISE =  PEEK ( - 16336) +  PEEK ( - 16336)
 560  NEXT K
 570  RETURN 
 580  POKE 1,2
 590  FOR K = 45 TO 40 STEP  - 1
 600  POKE 0,K
 610  CALL 2
 620  NEXT K
 630  RETURN 
 640  REM ***DEFENDER'S FIRE***
 650  POKE 1,2
 660  FOR K = 45 TO 40 STEP  - 1
 670  POKE 0,K
 680  CALL 2
 690  NEXT K
 700  RETURN 
 710  REM *** HIT ***
 720  FOR K = 1 TO 5
 730 NOISE =  PEEK ( - 16336) +  PEEK ( - 16336) +  PEEK ( - 16336) +  PEEK 
     ( - 16336) +  PEEK ( - 16336)
 740  IF  INT ( RND (1) * 2) < 1 THEN 730
 750 NOISE =  PEEK ( - 16336) +  PEEK ( - 16336)
 760  NEXT K
 770  RETURN 
 780  REM ***COMBAT SUBROUTINE
 790 DE = SHIPS(FDES(J))
 800 A = FSTR(J)
 810  PRINT 
 820  PRINT "SUBSPACE COMMUNICATION"
 830  IF CNT(FDES(J)) = FCN(J) THEN 1190
 840  PRINT "WORLD ";FDES(J);" WITH ";DE;" SHIPS"
 850  PRINT "CONTROLLED BY PLAYER ";CNT(FDES(J));"."
 860  PRINT "IS UNDER ATTACK BY A FLEET OF ";A;" SHIPS."
 870  PRINT "UNDER THE CONTROL OF PLAYER ";FCN(J);"."
 880  PRINT "DEFENDER FIRES...HITS ";
 890  FOR I = 1 TO DE
 900  IF  INT ( RND (1) * 3) + 1 < 2 THEN 950
 910  GOSUB 720
 920  PRINT "*";
 930 A = A - 1
 940  IF A = 0 THEN 1090
 950  NEXT I
 960  PRINT 
 970  PRINT "ATTACKER FIRES... HITS:";
 980  FOR I = 1 TO A
 990  IF  INT ( RND (1) * 3) + 1 < 2 THEN 1040
 1000  GOSUB 720
 1010  PRINT "*";
 1020 DE = DE - 1
 1030  IF DE = 0 THEN 1140
 1040  NEXT I
 1050  PRINT 
 1060  GOTO 880
 1070  PRINT "ATTACKERS WIN WITHOUT A FIGHT."
 1080  GOTO 1160
 1090  PRINT 
 1100  PRINT "DEFENDERS FIGHT OFF THE AGGRESSORS."
 1110  PRINT DE;" SHIPS LEFT."
 1120 SHIPS(DES(J)) = A
 1130  GOTO 1180
 1140  PRINT 
 1150  PRINT "ATTACKERS ARE VICTORIOUS. ";A;" SHIPS LEFT."
 1160 CNT(FDES(J)) = FCN(J)
 1170 SHIPS(FDES(J)) = A
 1180  RETURN 
 1190  PRINT "WORLD ";FDES(J);" BELONGING TO PLAYER ";FCN(J)
 1200  PRINT "HAS BEEN REINFORCED BY ";A;" SHIPS"
 1210 SHIPS(FDES(J)) = SHIPS(FDES(J)) + A
 1220  GOTO 1180
 1230  REM  *** FLEET ORDER INPUT
 1240  POKE 34,22
 1250  PRINT "PLAYER ";I;" FROM WORLD:";
 1260  GOSUB 1710
 1270  IF K = 141 THEN 1310
 1280  GOSUB 540
 1290  HTAB (1)
 1300  GOTO 1250
 1310  IF V = 0 THEN 1670
 1320  IF V <  = WRLDS THEN 1360
 1330  GOSUB 540
 1340  HTAB (1)
 1350  GOTO 1250
 1360  IF CNT(V) = I THEN 1410
 1370  GOSUB 540
 1380  PRINT 
 1390  PRINT "YOU DON'T CONTROL THAT WORLD."
 1400  GOTO 1250
 1410  REM 
 1420 V1 = V
 1430  PRINT "TO WORLD:"
 1440  GOSUB 1710
 1450  IF K = 141 THEN 1490
 1460  GOSUB 540
 1470  GOTO 1250
 1480  HTAB (1)
 1490  IF V > 0 AND V <  = WRLDS THEN 1520
 1500  GOSUB 540
 1510  GOTO 1250
 1520  REM 
 1530 V2 = V
 1540  PRINT "NUMBER OF SHIPS:"
 1550  GOSUB 1710
 1560  IF K = 141 THEN 1590
 1570  GOSUB 540
 1580  GOTO 1250
 1590  IF V > 0 THEN 1630
 1600  GOSUB 540
 1610  HTAB (1)
 1620  GOTO 1250
 1630  IF V <  = SHIPS(V1) THEN 1690
 1640  GOSUB 540
 1650  PRINT "YOU DON'T HAVE THAT MANY SHIPS THERE."
 1660  GOTO 1250
 1670  PRINT 
 1680  POKE 34,0
 1690  RETURN 
 1700  REM  ** CHARTR INPUT ROUTNE
 1710 V = 0
 1720  IF  PEEK ( - 16384) < 127 THEN 1720
 1730 K =  PEEK ( - 16384): POKE  - 16368,0
 1740  IF K < 176 OR K > 185 THEN  RETURN 
 1750 V = V * 10 + K - 176: GOTO 1720
 1760  REM *** DIST CALC ROUTINE
 1770 D2 = (LX(V1) - LX(V2)) ^ 2 + (LY(V1) - LY(V2)) ^ 2
 1780 D = 0
 1790 D = D + 1
 1800 D1 = D ^ 2
 1810  IF D2 > D1 THEN 1790
 1820  RETURN 
 1830  REM  *** RULES ***
 1840  PRINT 
 1850  RETURN 
 1860  REM  *** RULES END HERE
 1870  RETURN 
 1880  REM  *** PLAYERS INPUT
 1890  PRINT "HOW MANY PLAYERS (1-20)";
 1900  INPUT PLAYERS
 1910  IF PLAYERS >  = 1 AND PLAYERS <  = 20 THEN 1940
 1920  GOSUB 540
 1930  GOTO 1890
 1940  PRINT "HOW MANY WORLDS (5-40) ";
 1950  INPUT WRLDS
 1960  IF WRLDS >  = PLAYERS AND WRLDS <  = 40 THEN 1990
 1970  GOSUB 540
 1980  GOTO 1940
 1990  PRINT "HOW MANY TURNS IN THE GAME (1-100). ";
 2000  INPUT TURNS
 2010  IF TURNS >  = 1 AND TURNS <  = 100 THEN 2040
 2020  GOSUB 540
 2030  GOTO 1990
 2040  PRINT "DO YOU WANT THE NEUTRAL WORLDS TO BUILD"
 2050  PRINT "DEFENSIVE SHIPS ";
 2060  INPUT IN$
 2070  IF  LEFT$ (IN$,1) = "Y" THEN 2110
 2080  IF  LEFT$ (IN$,1) = "N" THEN 2120
 2090  GOSUB 540
 2100  GOTO 2040
 2110 AUTBLD = 1
 2120  RETURN 
 2130  REM *** GENERATE STAR LOCATIONS
 2140 LX(1) =  INT ( RND (1) * 20) + 1
 2150 LY(1) =  INT ( RND (1) * 20) + 1
 2160  FOR I = 2 TO WRLDS
 2170 LX(I) =  INT ( RND (1) * 20) + 1
 2180 LY(I) =  INT ( RND (1) * 20) + 1
 2190  FOR J = 1 TO I - 1
 2200  IF LX(I) = LX(J) AND LY(I) = LY(J) THEN 2170
 2210  NEXT J
 2220  NEXT I
 2230  REM *** STAR MAP ***
 2240  CALL  - 936
 2250  PRINT "*******STAR MAP*******"
 2260  FOR I = 1 TO WRLDS
 2270  HTAB (LX(I) * 2 - 1): VTAB (LY(I) + 1)
 2280  PRINT I
 2290  NEXT I
 2300  VTAB (22)
 2310  PRINT "NEW SETUP ";
 2320  INPUT IN$
 2330  IF  LEFT$ (IN$,1) <  > "Y" THEN 2360
 2340  GOSUB 2140
 2350  GOTO 2240
 2360  RETURN 
 2370  REM *** INDUSTRY ARRAY SETUP
 2380  FOR I = 1 TO PLAYERS
 2390 IND(I) = 10
 2400  NEXT I
 2410  FOR I = 1 + PLAYERS TO WRLDS
 2420 IND(I) =  INT ( RND (1) * 5) + 1
 2430  NEXT I
 2440  RETURN 
 2450  REM *** CNTRL ARRY SETUP
 2460  FOR I = 1 TO PLAYERS
 2470 CNT(I) = I
 2480  NEXT I
 2490  RETURN 
 2500  REM  *** SHIP ARRY SETUP
 2510  FOR I = 1 TO PLAYERS
 2520 SHIPS = 0
 2530 V1 = I
 2540  FOR J = 1 + PLAYERS TO WRLDS
 2550 V2 = J
 2560  GOSUB 1770
 2570 SHIPS = SHIPS + 100 / (D + 2)
 2580  NEXT J
 2590 SHIPS(I) = WRLDS * (5 + 400 / SHIPS)
 2600 SHIPS(I) =  INT (SHIPS(I))
 2610  NEXT I
 2620  FOR I = 1 + PLAYERS TO WRLDS
 2630 SHIPS(I) = SHIPS(I) +  INT ( RND (1) * IND(I) + 3)
 2640  IF  INT ( RND (1) * 3) + 1 < 2 THEN 2630
 2650  NEXT I
 2660  RETURN 
 2670  REM *** STAR LOCATION PRINT
 2680  CALL  - 936
 2690  PRINT "WORLD  X   Y"; TAB( 21);"WORLD  X   Y"
 2700  FOR I = 1 TO  INT (WRLDS / 2)
 2710  PRINT I;: HTAB (8): PRINT LX(I);: HTAB (12): PRINT LY(I)
 2720  NEXT I
 2730  VTAB (2)
 2740  FOR I =  INT (WRLDS / 2) + 1 TO WRLDS
 2750  HTAB (21): PRINT I;: HTAB (28): PRINT LX(I);: HTAB (33): PRINT LY(
     I)
 2760  NEXT I
 2770  PRINT "PREPARE YOUR STRMAP USING THE ABOVE"
 2780  PRINT "DATA. ON A SHEET OF GRAPH PAPER MAKE A"
 2790  PRINT "20X20 GRID WITH 0,0 IN THE UPPER LEFT."
 2800  INPUT "TYPE GO WHEN YOU ARE FINISHED ";IN$
 2810  RETURN 
 2820  REM  *** FLEET ORDERS
 2830  FOR I = 1 TO PLAYERS
 2840  GOSUB 1240
 2850  IF V = 0 THEN 2990
 2860  REM  *** LOAD SHIPS ONTO FLEET
 2870  GOSUB 1770
 2880  FOR J = 1 TO 100
 2890  IF FDES(J) <  > 0 THEN 2960
 2900 SHIPS(V1) = SHIPS(V1) - V
 2910 FDES(J) = V2
 2920 FCNT(J) = I
 2930 FTIM(J) = TRN +  INT (D / 3)
 2940 FSTR(J) = V
 2950  GOTO 2840
 2960  NEXT J
 2970  PRINT "SORRY FLEET SHORTAGE. ";: CALL  - 868
 2980  GOTO 3000
 2990  NEXT I
 3000  RETURN 
 3010  REM *** BUILD NEW SHIPS
 3020  FOR I = 1 TO WRLDS
 3030  IF AUTBLD = 1 THEN 3050
 3040  IF CNT(I) = 0 THEN 3060
 3050 SHIPS(I) = SHIPS(I) + IND(I)
 3060  NEXT I
 3070  RETURN 
 3080  REM  *** MOVE FLEETS
 3090  FOR J = 1 TO 100
 3100  IF FDES(J) = 0 THEN 3170
 3110  IF FTIM(J) = TRN THEN  GOSUB 790
 3120  GOTO 3170
 3130  GOSUB 790
 3140 FDES(J) = 0
 3150  PRINT "TYPE 'GO' TO CONTINUE "
 3160  INPUT IN$
 3170  NEXT J
 3180  RETURN 
 3190  REM  *** WORLD DATA DISPLAY
 3200  CALL  - 936
 3210  PRINT "RESULTS FOR TURN ";TRN: PRINT 
 3220  PRINT "WRLD CONT PROD SHPS WRLD CONT PROD SHPS"
 3230  FOR I = 1 TO  INT (WRLDS / 2)
 3240  PRINT I;: HTAB (6): PRINT CNT(I);
 3250  IF CNT(I) = 0 THEN 3270
 3260  HTAB (11): PRINT IND(I);: HTAB (16): PRINT SHIPS(I);
 3270  PRINT : NEXT I
 3280  VTAB (4)
 3290  FOR I =  INT (WRLDS / 2) + 1 TO WRLDS
 3300  HTAB (21): PRINT I;: HTAB (26): PRINT CNT(I);
 3310  IF CNT(I) = 0 THEN 3330
 3320  HTAB (31): PRINT IND(I);: HTAB (36): PRINT SHIPS(I);
 3330  PRINT : NEXT I
 3340  RETURN 
 